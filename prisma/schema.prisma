generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://funny_user:funny_password@localhost:5440/policonsultorio"
}

model User {
  id       String @id @default(cuid())
  nombre   String
  email    String @unique
  password String
  rol      Role   @default(MESA_ENTRADA)
}

model ObraSocial {
  id            Int                     @id @default(autoincrement())
  nombre        String
  estado        EstadoObraSocial
  pacientes     Paciente[]
  profesionales ProfesionalObraSocial[]
}

model Profesional {
  id             Int                     @id @default(autoincrement())
  nombre         String
  apellido       String
  direccion      String
  dni            String                  @db.VarChar(9) @unique
  especialidad   String
  telefono       String                  @db.VarChar(14)
  historias      HistoriaClinica[]
  obras_sociales ProfesionalObraSocial[]
  turnos         Turno[]
}

model ProfesionalObraSocial {
  id             Int         @id @default(autoincrement())
  id_obra_social Int
  id_profesional Int
  obra_social    ObraSocial  @relation(fields: [id_obra_social], references: [id])
  profesional    Profesional @relation(fields: [id_profesional], references: [id])
}

model Paciente {
  id               Int               @id @default(autoincrement())
  nombre           String
  apellido         String
  dni              String            @db.VarChar(9) @unique
  direccion        String
  fecha_nacimiento DateTime
  fecha_registro   DateTime          @default(now())
  telefono         String            @db.VarChar(14)
  id_obra_social   Int?
  num_obra_social  String?
  historias        HistoriaClinica[]
  obra_social      ObraSocial?       @relation(fields: [id_obra_social], references: [id])
  turnos           Turno[]
}

model HistoriaClinica {
  id             Int         @id @default(autoincrement())
  id_paciente    Int
  motivo         String
  detalle        String
  fecha          DateTime    @default(now())
  id_profesional Int
  paciente       Paciente    @relation(fields: [id_paciente], references: [id])
  profesional    Profesional @relation(fields: [id_profesional], references: [id])
}

model Turno {
  id             Int         @id @default(autoincrement())
  id_profesional Int
  id_paciente    Int
  fecha          DateTime
  estado         EstadoTurno
  paciente       Paciente    @relation(fields: [id_paciente], references: [id])
  profesional    Profesional @relation(fields: [id_profesional], references: [id])
}

enum Role {
  MESA_ENTRADA
  PROFESIONAL
  GERENTE
}

enum EstadoObraSocial {
  ACTIVA
  INACTIVA
}

enum EstadoTurno {
  CANCELADO
  CONFIRMADO
}
